<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html> <head>
     <title>Apophenia: a library for scientific computing</title>
<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>
     <link rel="stylesheet" href="typical.css" type="text/css" >
     <script  type="text/javascript" language="JavaScript" src="tree.js"></script>
</head><body>
     <center><table cellpadding=10pt>
     <tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td> 
    <td><table>
     	<tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
<tr><td><div class="qindex"><a class="qindex" href="index.html">&nbsp;Intro</a> | <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="globals.html">Index</a> <!--| <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
	</td></tr></table></center>
    <div> <!--Doxygen generates an extra </div>.-->
<!-- Generated by Doxygen 1.8.9.1 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">apop_mle.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgrad__params.html">grad_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinfostruct.html">infostruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structapop__model__for__infomatrix__struct.html">apop_model_for_infomatrix_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa927b4dbd7ec67eaec805be6af71df58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa927b4dbd7ec67eaec805be6af71df58"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>Onecheck</b>(str)&#160;&#160;&#160;if (!strcasecmp(m, #str)) return 0;</td></tr>
<tr class="separator:aa927b4dbd7ec67eaec805be6af71df58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad8137c8372c8b1cb27cfa3965826e054"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad8137c8372c8b1cb27cfa3965826e054"></a>
typedef long double(*&#160;</td><td class="memItemRight" valign="bottom"><b>apop_fn_with_params</b>) (<a class="el" href="structapop__data.html">apop_data</a> *, <a class="el" href="structapop__model.html">apop_model</a> *)</td></tr>
<tr class="separator:ad8137c8372c8b1cb27cfa3965826e054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cf08cc0396d9b7ca5bc98e39736661"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a21cf08cc0396d9b7ca5bc98e39736661"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>apop_df_with_void</b>) (const gsl_vector *beta, void *d, gsl_vector *gradient)</td></tr>
<tr class="separator:a21cf08cc0396d9b7ca5bc98e39736661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32d4d407ad8ff8a2a885363191a903c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32d4d407ad8ff8a2a885363191a903c8"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>apop_fdf_with_void</b>) (const gsl_vector *beta, void *d, double *f, gsl_vector *df)</td></tr>
<tr class="separator:a32d4d407ad8ff8a2a885363191a903c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa1a5d5ac307679f87428389ed0b6dea7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa1a5d5ac307679f87428389ed0b6dea7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Apop_settings_copy</b> (<a class="el" href="apop_8h.html#a833e962fb042462eeadada7484671f07">Apop_settings_free</a>(apop_parts_wanted)</td></tr>
<tr class="separator:aa1a5d5ac307679f87428389ed0b6dea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b6ecb8702153658c29369dc2e7cfba9"><td class="memItemLeft" align="right" valign="top">gsl_vector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__linear__algebra.html#ga1b6ecb8702153658c29369dc2e7cfba9">apop_numerical_gradient</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *model, double delta)</td></tr>
<tr class="separator:ga1b6ecb8702153658c29369dc2e7cfba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a55a20880947e289767aad6e5b0117c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apop__mle_8c.html#a1a55a20880947e289767aad6e5b0117c">apop_model_hessian</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *model, double delta)</td></tr>
<tr class="separator:a1a55a20880947e289767aad6e5b0117c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2784b69175d1ecd3833d228d2294e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apop__mle_8c.html#a0f2784b69175d1ecd3833d228d2294e7">apop_model_numerical_covariance</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *model, double delta)</td></tr>
<tr class="separator:a0f2784b69175d1ecd3833d228d2294e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26cdf8ffbd8508760493d050912d4db7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a26cdf8ffbd8508760493d050912d4db7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>add_info_criteria</b> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m, <a class="el" href="structapop__model.html">apop_model</a> *est, double ll, int param_ct)</td></tr>
<tr class="separator:a26cdf8ffbd8508760493d050912d4db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ca4d3f885902fd098164784933ca81"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a58ca4d3f885902fd098164784933ca81"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>get_desires</b> (<a class="el" href="structapop__model.html">apop_model</a> *m, <a class="el" href="structinfostruct.html">infostruct</a> *info)</td></tr>
<tr class="separator:a58ca4d3f885902fd098164784933ca81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae63a95bb30181d8f6533a6421e130fb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aae63a95bb30181d8f6533a6421e130fb"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>check_method</b> (char *m)</td></tr>
<tr class="separator:aae63a95bb30181d8f6533a6421e130fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9f092d1786034dd2ab22c63de5c955c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mle.html#gae9f092d1786034dd2ab22c63de5c955c">apop_maximum_likelihood</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *dist)</td></tr>
<tr class="separator:gae9f092d1786034dd2ab22c63de5c955c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d5e39c00012de5b51cd49ce1ffd31fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mle.html#ga6d5e39c00012de5b51cd49ce1ffd31fe">apop_estimate_restart</a> (<a class="el" href="structapop__model.html">apop_model</a> *e, <a class="el" href="structapop__model.html">apop_model</a> *copy, char *starting_pt, double boundary)</td></tr>
<tr class="separator:ga6d5e39c00012de5b51cd49ce1ffd31fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac1edb6b92c9ab09f0c9195796ff3bd9c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1edb6b92c9ab09f0c9195796ff3bd9c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>default_delta</b> = 1e-3</td></tr>
<tr class="separator:ac1edb6b92c9ab09f0c9195796ff3bd9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a89f595f61fc0f3a5fcea77ef2a862"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>apop_model_for_infomatrix</b></td></tr>
<tr class="separator:a73a89f595f61fc0f3a5fcea77ef2a862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ad8c78475de735d471aae82741113b3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8ad8c78475de735d471aae82741113b3"></a>
jmp_buf&#160;</td><td class="memItemRight" valign="bottom"><b>anneal_jump</b></td></tr>
<tr class="separator:a8ad8c78475de735d471aae82741113b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The MLE functions. Call them with an <a class="el" href="structapop__model.html">apop_model</a>.</p>
<p>This file includes a number of distributions and models whose parameters one would estimate using maximum likelihood techniques.</p>
<p>It has (more-or-less) a single public function: <a class="el" href="group__mle.html#gae9f092d1786034dd2ab22c63de5c955c">apop_maximum_likelihood</a>, and you don't even need to use that one, because the <code>apop_estimate</code> function defaults to using it if there is no model-specific estimation routine provided.</p>
<p>At the bottom are the maximum likelihood procedures themselves. There are four: Newton-type derivative methods, the no-derivative version, the with-derivative version, and the simulated annealing routine. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1a55a20880947e289767aad6e5b0117c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__data.html">apop_data</a>* apop_model_hessian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Numerically estimate the matrix of second derivatives of the parameter values. The math is simply a series of re-evaluations at small differential steps. [Therefore, it may be expensive to do this for a very computationally-intensive model.]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The data at which the model was estimated </td></tr>
    <tr><td class="paramname">model</td><td>The model, with parameters already estimated </td></tr>
    <tr><td class="paramname">delta</td><td>the step size for the differentials. The current default is around 1e-3. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The matrix of estimated second derivatives at the given data and parameter values.</dd></dl>
<ul>
<li>This function uses the <a class="el" href="designated.html">Designated initializers</a> syntax for inputs. </li>
</ul>

</div>
</div>
<a class="anchor" id="a0f2784b69175d1ecd3833d228d2294e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__data.html">apop_data</a>* apop_model_numerical_covariance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Produce the covariance matrix for the parameters of an estimated model via the derivative of the score function at the parameter. I.e., I find the second derivative via <a class="el" href="apop__mle_8c.html#a1a55a20880947e289767aad6e5b0117c">apop_model_hessian</a> , and take the negation of the inverse.</p>
<p>I follow Efron and Hinkley in using the estimated information matrix&mdash;the value of the information matrix at the estimated value of the score&mdash;not the expected information matrix that is the integral over all possible data. See Pawitan 2001 (who cribbed a little off of Efron and Hinkley) or Klemens 2008 (who directly cribbed off of both) for further details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The data by which your model was estimated </td></tr>
    <tr><td class="paramname">model</td><td>A model whose parameters have been estimated. </td></tr>
    <tr><td class="paramname">delta</td><td>The differential by which to step for sampling changes. (default currently = 1e-3) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A covariance matrix for the data. Also, if the data does not have a <code>"Covariance"</code> page, I'll set it to the result as well [i.e., I won't overwrite an existing covar].</dd></dl>
<p>This function uses the <a class="el" href="designated.html">Designated initializers</a> syntax for inputs. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a73a89f595f61fc0f3a5fcea77ef2a862"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structapop__model.html">apop_model</a>* apop_model_for_infomatrix</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= &amp;(<a class="code" href="apop_8h.html#afe86ae10fc82d219906211e4f88e4cf9">apop_model</a>){<span class="stringliteral">&quot;Ad hoc model for working out the information matrix.&quot;</span>, </div>
<div class="line">                                                .log_likelihood = apop_fn_for_infomatrix}</div>
<div class="ttc" id="apop_8h_html_afe86ae10fc82d219906211e4f88e4cf9"><div class="ttname"><a href="apop_8h.html#afe86ae10fc82d219906211e4f88e4cf9">apop_model</a></div><div class="ttdeci">struct apop_model apop_model</div><div class="ttdef"><b>Definition:</b> apop.h:99</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<p><p>
<div class="tiny">Autogenerated by doxygen on Mon Apr 20 2015.</div></body></html>

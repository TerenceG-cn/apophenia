<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
     <title>Apophenia: a library for scientific computing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
     <link rel="stylesheet" href="typical.css" type="text/css" >
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="typical.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<center><table cellpadding=10pt>
<tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td>
<td><table>
    <tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
    <tr><td><div class="qindex"> <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="group__all__public.html">Index </a>  |         <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
                <!-- <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
                                  </td></tr></table></center>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('testpage.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tests &amp; diagnostics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here is the model for all hypothesis testing within Apophenia:</p>
<ul>
<li>Calculate a statistic. </li>
<li>Describe the distribution of that statistic. </li>
<li>Work out how much of the distribution is (above|below|closer to zero than) the statistic.</li>
</ul>
<p>There are a handful of named tests that produce a known statistic and then compare to a known distribution, like <a class="el" href="group__all__public.html#gacc11c9f057815789a5442c53fc8616f5">apop_test_kolmogorov</a> or <a class="el" href="group__all__public.html#ga3939d841de85bfc6b51fa40b01a9d1b6">apop_test_fisher_exact</a>. For traditional distributions (Normal, <img class="formulaInl" alt="$t$" src="form_45.png"/>, <img class="formulaInl" alt="$\chi^2$" src="form_16.png"/>), use the <a class="el" href="group__all__public.html#ga650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a> convenience function.</p>
<p>In especially common cases, like the parameters from an OLS regression, the commonly-associated <img class="formulaInl" alt="$t$" src="form_45.png"/> test is included as part of the estimation output, typically as a row in the <code>info</code> element of the output <a class="el" href="structapop__model.html">apop_model</a>.</p>
<ul>
<li><a class="el" href="group__all__public.html#ga650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a> </li>
<li><a class="el" href="group__all__public.html#ga1d0559b92134107013e3f977837ecffa">apop_paired_t_test</a> </li>
<li><a class="el" href="group__all__public.html#ga9a1c9f74abd42f2776683b4ccd71a831">apop_f_test</a> </li>
<li><a class="el" href="group__all__public.html#gae4c01436544867b9a35a76f8aef6ad18">apop_t_test</a> </li>
<li><a class="el" href="group__all__public.html#ga40bac17a1d571ac77503f47f43607724">apop_test_anova_independence</a> </li>
<li><a class="el" href="group__all__public.html#ga3939d841de85bfc6b51fa40b01a9d1b6">apop_test_fisher_exact</a> </li>
<li><a class="el" href="group__all__public.html#gacc11c9f057815789a5442c53fc8616f5">apop_test_kolmogorov</a> </li>
<li><a class="el" href="group__all__public.html#ga03378d8c8286659d21ce29d14625d269">apop_estimate_coefficient_of_determination</a> </li>
<li>apop_estimate_r_squared</li>
</ul>
<p>See also these Monte Carlo methods:</p>
<ul>
<li><a class="el" href="group__all__public.html#gaaa1c1b086333129e3dbf2d108c928d71">apop_bootstrap_cov</a> </li>
<li><a class="el" href="group__all__public.html#ga3dd5951853d069eb9ef79c8e26b0aea8">apop_jackknife_cov</a></li>
</ul>
<p>To give another example of testing, here is a function that was briefly a part of Apophenia, but seemed a bit out of place. Here it is as a sample:</p>
<div class="fragment"><div class="line"><span class="comment">// Input: any vector, which will be normalized in place. Output: 1 - the p-value</span></div><div class="line"><span class="comment">// for a chi-squared test to answer the question, &quot;with what confidence can I</span></div><div class="line"><span class="comment">// reject the hypothesis that the variance of my data is zero?&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">double</span> apop_test_chi_squared_var_not_zero(gsl_vector *in){</div><div class="line">    <a class="code" href="group__all__public.html#gabd17601e642688d033f62d346f3dace6">Apop_stopif</a>(!in, <span class="keywordflow">return</span> NAN, 0, <span class="stringliteral">&quot;input vector is NULL. Doing nothing.&quot;</span>);</div><div class="line">    <a class="code" href="group__all__public.html#ga194ad92b1bc632ba1d13d9958c7b5b4d">apop_vector_normalize</a>(in, .normalization_type=<span class="charliteral">&#39;s&#39;</span>);</div><div class="line">    <span class="keywordtype">double</span> sum=<a class="code" href="group__all__public.html#gaa1a135fcdd8ea6f9cbc0d518773d6c3c">apop_vector_map_sum</a>(in, gsl_pow_2);</div><div class="line">    <span class="keywordflow">return</span> gsl_cdf_chisq_P(sum, in-&gt;size);</div><div class="line">}</div></div><!-- fragment --><p>Or, consider the Rao statistic, <img class="formulaInl" alt="${\partial\over \partial\beta}\log L(\beta)'I^{-1}(\beta){\partial\over \partial\beta}\log L(\beta)$" src="form_125.png"/> where <img class="formulaInl" alt="$L$" src="form_126.png"/> is a model's likelihood function and <img class="formulaInl" alt="$I$" src="form_127.png"/> its information matrix. In code:</p>
<div class="fragment"><div class="line"><a class="code" href="structapop__data.html">apop_data</a> * infoinv = <a class="code" href="group__all__public.html#ga6f1e70092a9566a5ecd7a6e6c10a0e21">apop_model_numerical_covariance</a>(data, your_model);</div><div class="line"><a class="code" href="structapop__data.html">apop_data</a> * score = &amp;(<a class="code" href="structapop__data.html">apop_data</a>*){.vector=<a class="code" href="group__all__public.html#ga2978392b9ac3c35cccf39e7858b7a8b5">apop_numerical_gradient</a>(data, your_model)};</div><div class="line"><a class="code" href="structapop__data.html">apop_data</a> * stat = <a class="code" href="group__all__public.html#ga5c3f14f4c1c27029ad67910f6d0f51a1">apop_dot</a>(<a class="code" href="group__all__public.html#ga5c3f14f4c1c27029ad67910f6d0f51a1">apop_dot</a>(score, infoinv), score);</div></div><!-- fragment --><p>Given the correct assumptions, this is <img class="formulaInl" alt="$\sim \chi^2_m$" src="form_128.png"/>, where <img class="formulaInl" alt="$m$" src="form_129.png"/> is the dimension of <img class="formulaInl" alt="$\beta$" src="form_7.png"/>, so the odds of a Type I error given the model is:</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> p_value = <a class="code" href="group__all__public.html#ga650d1ecf6f78c3bdb85c8fce71dfae05">apop_test</a>(stat, <span class="stringliteral">&quot;chi squared&quot;</span>, beta-&gt;size);</div></div><!-- fragment --><p><em>Generalized parameter tests</em></p>
<p>But if your model is not from the textbook, then you have the tools to apply the above three-step process to the parameters of any <a class="el" href="structapop__model.html">apop_model</a>.</p>
<ul>
<li>Model parameters are a statistic, and you know that <code>apop_estimate(your_data, your_model)</code> will output a model with a <code>parameters</code> element. </li>
<li><a class="el" href="group__all__public.html#ga5d107db6b68b8fc9f4087b90b6362405">apop_parameter_model</a> will return an <a class="el" href="structapop__model.html">apop_model</a> describing the distribution of these parameters. </li>
<li>We now have the two ingredients to send to <a class="el" href="group__all__public.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>, which takes in a model and a data point and returns the area under the data point.</li>
</ul>
<p>Defaults for the parameter models are filled in via bootstrapping or resampling, meaning that if your model's parameters are decidedly off the Normal path, you can still test claims about the parameters.</p>
<p>The introductory example in <a class="el" href="gentle.html">A quick overview</a> ran a standard OLS regression, whose output includes some standard hypothesis tests; to conclude, let us go the long way and replicate those results via the general <a class="el" href="group__all__public.html#ga5d107db6b68b8fc9f4087b90b6362405">apop_parameter_model</a> mechanism. The results here will of course be identical, but the more general mechanism can be used in situations where the standard models don't apply.</p>
<p>The first part of this program is identical to the introductory program, using <code>ss08pdc.csv</code> if you have downloaded it as per the instructions in <a class="el" href="gentle.html">A quick overview</a>, or a simple sample data set if not. The second half executes the three steps uses many of the above features: one of the inputs to <a class="el" href="group__all__public.html#ga5d107db6b68b8fc9f4087b90b6362405">apop_parameter_model</a> (which row of the parameter set to use) is sent by adding a settings group, we pull that row into a separate data set using <a class="el" href="group__all__public.html#ga401dbc60c9915be8e4c4def68b22d755">Apop_r</a>, and we set its vector value by referring to it as the -1st element.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;apop.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>){</div><div class="line">    <span class="keywordtype">char</span> *datafile = (access(<span class="stringliteral">&quot;ss08pdc.csv&quot;</span>, R_OK)!=-1) ? <span class="stringliteral">&quot;ss08pdc.csv&quot;</span> : <span class="stringliteral">&quot;data&quot;</span>;</div><div class="line">    <a class="code" href="group__all__public.html#gabd00e16791a970631c3ed4ac3487da46">apop_text_to_db</a>(.text_file=datafile, .tabname=<span class="stringliteral">&quot;dc&quot;</span>);</div><div class="line">    <a class="code" href="structapop__data.html">apop_data</a> *data = apop_query_to_data(<span class="stringliteral">&quot;select log(pincp+10), agep, sex &quot;</span></div><div class="line">                                    <span class="stringliteral">&quot;from dc where agep+ pincp+sex is not null and pincp&gt;=0&quot;</span>);</div><div class="line">    <a class="code" href="structapop__model.html">apop_model</a> *est = <a class="code" href="group__all__public.html#gaf78221aa4167b7b52bdd0a26aab8e576">apop_estimate</a>(data, <a class="code" href="group__models.html#ga85524b1deabd5829227888fd91740cc3">apop_ols</a>);</div><div class="line">    apop_model_show(est);</div><div class="line"></div><div class="line">    <a class="code" href="group__all__public.html#ga8fb1877a3cc29edd685a68dd6b4a35dc">Apop_settings_add_group</a>(est, apop_pm, .index =1);  </div><div class="line">    <a class="code" href="structapop__model.html">apop_model</a> *first_param_distribution = <a class="code" href="group__all__public.html#ga5d107db6b68b8fc9f4087b90b6362405">apop_parameter_model</a>(data, est);</div><div class="line"></div><div class="line">    Apop_row(est-&gt;parameters, 1, param);</div><div class="line">    <span class="keywordtype">double</span> area_under_p = <a class="code" href="group__all__public.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>(param, first_param_distribution);</div><div class="line"></div><div class="line">    <a class="code" href="group__all__public.html#ga5bdc618669b9ddc8239595d7b50bec9e">apop_data_set</a>(param, 0, -1, .val=0);</div><div class="line">    <span class="keywordtype">double</span> area_under_zero = <a class="code" href="group__all__public.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>(param, first_param_distribution);</div><div class="line">    printf(<span class="stringliteral">&quot;reject the null for agep with %g percent confidence.\n&quot;</span>,</div><div class="line">                                 100*(2*fabs(area_under_p-area_under_zero)));</div><div class="line">}</div></div><!-- fragment --><p>Note that the procedure did not assume the model parameters had a certain form. It queried the model for the distribution of parameter <code>agep</code>, and if the model didn't have a closed-form answer then a distribution via bootstrap would be provided. Then that model was queried for its CDF. [The procedure does assume a symmetric distribution. Fixing this is left as an exercise for the reader.] For a model like OLS, this is entirely overkill, which is why OLS provides the basic hypothesis tests automatically. But for models where the distribution of parameters is unknown or has no closed-form solution, this may be the only recourse. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
</body></html>

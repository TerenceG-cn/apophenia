<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html> <head>
     <title>Apophenia: a library for scientific computing</title>

<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>


     <link rel="stylesheet" href="typical.css" type="text/css" >
     <script  type="text/javascript" language="JavaScript" src="tree.js"></script>
</head><body>
     <center><table cellpadding=10pt>
     <tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td> 
    <td><table>
     	<tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
<tr><td><div class="qindex"><a class="qindex" href="index.html">&nbsp;Intro</a> | <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="globals.html">Index</a> <!--| <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
	</td></tr></table></center>

    <div> <!--Doxygen generates an extra </div>.-->
<!-- Generated by Doxygen 1.7.6.1 -->
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Notes on input text file formatting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Each row of the file will be converted to one record in the database or one row in the matrix. Values on one row are separated by delimiters. Fixed-width input is also OK; see below.</p>
<p>By default, the delimiters are set to "|,\t", meaning that a pipe, comma, or tab will delimit separate entries. To change the default, please use an argument to <a class="el" href="group__conversions.html#gabd00e16791a970631c3ed4ac3487da46">apop_text_to_db</a> or <a class="el" href="group__conversions.html#ga630de5d4fcbe9ef13373029f5d813a97">apop_text_to_data</a> like <code>.delimiters=" \t"</code> or <code>.delimiters="|"</code>. <code>apop_opts.input_delimiters</code> is deprecated.</p>
<p>The input text file must be UTF-8 or traditional ASCII encoding. Delimiters must be ASCII characters. If your data is in another encoding, try the POSIX-standard <code>iconv</code> program to filter the data to UTF-8.</p>
<ul>
<li>The character after a backslash is read as a normal character, even if it is a delimiter, <code>#</code>, <code>'</code>, or <code>"</code>.</li>
</ul>
<ul>
<li>If a field contains several such special characters, surround it by <code>'s</code> or <code>"s</code>. The surrounding marks are stripped and the text read verbatim.</li>
</ul>
<ul>
<li>Text does not need to be delimited by quotes (unless there are special characters). If a text field is quote-delimited, I'll strip them. E.g., "Males, 30-40", is an OK column name, as is "Males named \\"Joe\"".</li>
</ul>
<ul>
<li>Everything after a # is taken to be comments and ignored.</li>
</ul>
<ul>
<li>Blank lines (empty or consisting only of white space) are also ignored.</li>
</ul>
<ul>
<li>If you are reading into an array or <code>gsl_matrix</code> or <a class="el" href="gentle.html#apop_data">apop_data</a> set, all text fields are taken as zeros. You will be warned of such substitutions unless you set <div class="fragment"><pre class="fragment"> <a class="code" href="apop_8h.html#a7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#aa76e9237ed45c77bc883b428c3217a66">verbose</a>==0
</pre></div> beforehand.</li>
</ul>
<ul>
<li>There are often two delimiters in a row, e.g., "23, 32,, 12". When it's two commas like this, the user typically means that there is a missing value and the system should insert an NAN; when it is two tabs in a row, this is typically just a formatting glitch. Thus, if there are multiple delimiters in a row, I check whether the second (and subsequent) is a space or a tab; if it is, then it is ignored, and if it is any other delimiter (including the end of the line) then a NaN is inserted.</li>
</ul>
<p>If this rule doesn't work for your situation, you can explicitly insert a note that there is a missing data point. E.g., try: </p>
<div class="fragment"><pre class="fragment">          perl -pi.bak -e <span class="stringliteral">&#39;s/,,/,NaN,/g&#39;</span> data_file
</pre></div><p>If you have missing data delimiters, you will need to set <a class="el" href="structapop__opts__type.html">apop_opts.nan_string</a> to text that matches the given format. E.g.,</p>
<div class="fragment"><pre class="fragment"><span class="comment">//Apophenia&#39;s default NaN string, matching NaN, nan, or NAN, but not Nancy:</span>
<a class="code" href="apop_8h.html#a7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a547e96926c697556211b31eb5daf939f">nan_string</a> = <span class="stringliteral">&quot;NaN&quot;</span>;
<a class="code" href="apop_8h.html#a7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a547e96926c697556211b31eb5daf939f">nan_string</a> = <span class="stringliteral">&quot;Missing&quot;</span>;
<a class="code" href="apop_8h.html#a7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a547e96926c697556211b31eb5daf939f">nan_string</a> = <span class="stringliteral">&quot;.&quot;</span>;

<span class="comment">//Or, turn off nan-string checking entirely with:</span>
<a class="code" href="apop_8h.html#a7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a547e96926c697556211b31eb5daf939f">nan_string</a> = NULL;
</pre></div><p>SQLite stores these NaN-type values internally as <code>NULL</code>; that means that functions like <a class="el" href="group__queries.html#gade862993166c6482f53562fb77721db9">apop_query_to_data</a> will convert both your nan_string string and <code>NULL</code> to an <code>NaN</code> value.</p>
<ul>
<li>The system uses the standards for C's <code>atof()</code> function for floating-point numbers: INFINITY, -INFINITY, and NaN work as expected. I use some tricks to get SQLite to accept these values, but they work.</li>
</ul>
<ul>
<li>If there are row names and column names, then the input will not be perfectly square: there should be no first entry in the row with column names like 'row names'. That is, for a 100x100 data set with row and column names, there are 100 names in the top row, and 101 entries in each subsequent row (name plus 100 data points).</li>
</ul>
<ul>
<li>White space before or after a field is ignored. So <code>1, 2,3, 4 , 5, " six ",7 </code> is eqivalent to <code>1,2,3,4,5," six ",7</code>.</li>
</ul>
<ul>
<li>NUL characters are treated as white space, so if your fields have NULs as padding, you should have no problem. NULs inside of a string will probably break.</li>
</ul>
<ul>
<li>Fixed-width formats are supported (for plain ASCII encoding only), but you have to provide a list of field ending positions. For example, given <div class="fragment"><pre class="fragment">NUMLEOL
123AABB
456CCDD
</pre></div> we have three columns, named NUM, LE, and OL. The names can be read from the first row if you so specify. You will have to provide a list of integers giving the end of each field: 3, 5, 7. </li>
</ul>
</div></div><!-- contents -->
<p><p>
<div class="tiny">Autogenerated by doxygen on Fri Oct 24 2014.</div></body></html>

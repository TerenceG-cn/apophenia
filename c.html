<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
     <title>Apophenia: a library for scientific computing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
     <link rel="stylesheet" href="typical.css" type="text/css" >
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="typical.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<center><table cellpadding=10pt>
<tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td>
<td><table>
    <tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
    <tr><td><div class="qindex"> <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="group__all__public.html">Index </a>  |         <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
                <!-- <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
                                  </td></tr></table></center>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">C, SQL and coding utilities </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section user"><dt>Learning C</dt><dd></dd></dl>
<p><a href="http://modelingwithdata.org">Modeling with Data</a> has a full tutorial for C, oriented at users of standard stats packages. More nuts-and-bolts tutorials are <a href="http://www.google.com/search?hl=es&amp;amp;c2coff=1&amp;amp;q=c+tutorial">in abundance</a>. Some people find pointers to be especially difficult; fortunately, there's a <a href="http://www.youtube.com/watch?v=6pmWojisM_E">claymation cartoon</a> which clarifies everything.</p>
<dl class="section user"><dt>Header aggregation</dt><dd></dd></dl>
<p>There is only one header. Put </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;apop.h&gt;</span></div>
</div><!-- fragment --><p> at the top of your file, and you're done. Everything declared in that file starts with <code>apop_</code> (or <code>Apop_</code>).</p>
<dl class="section user"><dt>Linking</dt><dd></dd></dl>
<p>You will need to link to the Apophenia library, which involves adding the <code>-lapophenia</code> flag to your compiler. Apophenia depends on SQLite3 and the GNU Scientific Library (which depends on a BLAS), so you will probably need something like:</p>
<div class="fragment"><div class="line">gcc sample.c -lapophenia -lsqlite3 -lgsl -lgslcblas -o run_me -g -Wall -O3</div>
</div><!-- fragment --><p>Your best bet is to encapsulate this mess in a <a class="el" href="makefile.html">Makefile</a>. Even if you are using an IDE and its command-line management tools, see the Makefile page for notes on useful flags.</p>
<dl class="section user"><dt>Standards compliance</dt><dd></dd></dl>
<p>To the best of our abilities, Apophenia complies to the C standard (ISO/IEC 9899:2011). As well as relying on the GSL and SQLite, it uses some POSIX function calls, such as <code>strcasecmp</code> and <code>popen</code>.</p>
<dl class="section user"><dt>Easier calling syntax</dt><dd></dd></dl>
<p>Many functions allow optional named arguments to functions. For example: </p><div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga44a77f5e6867c627fd313f3f6e252ff8">apop_vector_distance</a>(v1, v2); <span class="comment">//assumes Euclidean distance</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga44a77f5e6867c627fd313f3f6e252ff8">apop_vector_distance</a>(v1, .metric=<span class="charliteral">&#39;M&#39;</span>); <span class="comment">//assumes v2=0, uses Manhattan metric.</span></div>
</div><!-- fragment --><p>See the <a class="el" href="designated.html">Designated initializers</a> page for details of this syntax.</p>
<p><a class="el" href="designated.html">Designated initializers</a></p>
<h1><a class="anchor" id="debugging"></a>
Errors, logging, debugging and stopping</h1>
<h5>The <code>error</code> element</h5>
<p>The <a class="el" href="gentle.html#apop_data">apop_data</a> set and the <a class="el" href="structapop__model.html">apop_model</a> both include an element named <code>error</code>. It is normally <code>0</code>, indicating no (known) error.</p>
<p>For example, <a class="el" href="group__all__public.html#gadd67e6838ce2521a1d756894dc9b5ccf">apop_data_copy</a> detects allocation errors and some circular links (when <code>Data-&gt;more == Data</code>) and fails in those cases. You could thus use the function with a form like</p>
<div class="fragment"><div class="line"><a class="code" href="structapop__data.html">apop_data</a> *d = <a class="code" href="group__all__public.html#ga630de5d4fcbe9ef13373029f5d813a97">apop_text_to_data</a>(<span class="stringliteral">&quot;indata&quot;</span>);</div>
<div class="line"><a class="code" href="structapop__data.html">apop_data</a> *cp = <a class="code" href="group__all__public.html#gadd67e6838ce2521a1d756894dc9b5ccf">apop_data_copy</a>(d);</div>
<div class="line"><span class="keywordflow">if</span> (cp-&gt;error) {printf(<span class="stringliteral">&quot;Couldn&#39;t copy the input data; failing.\n&quot;</span>); <span class="keywordflow">return</span> 1;}</div>
</div><!-- fragment --><p>There is sometimes (but not always) benefit to handling specific error codes, which are listed in the documentation of those functions that set the <code>error</code> element. E.g.,</p>
<div class="fragment"><div class="line"><a class="code" href="structapop__data.html">apop_data</a> *d = <a class="code" href="group__all__public.html#ga630de5d4fcbe9ef13373029f5d813a97">apop_text_to_data</a>(<span class="stringliteral">&quot;indata&quot;</span>);</div>
<div class="line"><a class="code" href="structapop__data.html">apop_data</a> *cp = <a class="code" href="group__all__public.html#gadd67e6838ce2521a1d756894dc9b5ccf">apop_data_copy</a>(d);</div>
<div class="line"><span class="keywordflow">if</span> (cp-&gt;error == <span class="charliteral">&#39;a&#39;</span>) {printf(<span class="stringliteral">&quot;Couldn&#39;t allocate space for the copy; failing.\n&quot;</span>); <span class="keywordflow">return</span> 1;}</div>
<div class="line"><span class="keywordflow">if</span> (cp-&gt;error == <span class="charliteral">&#39;c&#39;</span>) {printf(<span class="stringliteral">&quot;Circular link in the data set; failing.\n&quot;</span>); <span class="keywordflow">return</span> 2;}</div>
</div><!-- fragment --><p>The end of <a href="http://modelingwithdata.org/appendix_o.html">Appendix O</a> of <em>Modeling with Data</em> offers some GDB macros which can make dealing with Apophenia from the GDB command line much more pleasant. As discussed below, it also helps to set <code>apop_opts.stop_on_warning='v'</code> or <code>'w'</code> when running under the debugger.</p>
<h1><a class="anchor" id="verbsec"></a>
Verbosity level and logging</h1>
<p>The global variable <code>apop_opts.verbose</code> determines how many notifications and warnings get printed by Apophenia's warning mechanism:</p>
<p>-1: turn off logging, print nothing (ill-advised) <br />
 0: notify only of failures and clear danger <br />
 1: warn of technically correct but odd situations that might indicate, e.g., numeric instability <br />
 2: debugging-type information; print queries <br />
 3: give me everything, such as the state of the data at each iteration of a loop.</p>
<p>These levels are of course subjective, but should give you some idea of where to place the verbosity level. The default is 1.</p>
<p>The messages are printed to the <code>FILE*</code> handle at <code>apop_opts.log_file</code>. If this is blank (which happens at startup), then this is set to <code>stderr</code>. This is the typical behavior for a console program. Use</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a27e596063680b5b56ba5bf39fc2b6647">log_file</a> = fopen(<span class="stringliteral">&quot;mylog&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
</div><!-- fragment --><p>to write to the <code>mylog</code> file instead of <code>stderr</code>.</p>
<p>As well as the error and warning messages, some functions can also print diagnostics, using the <a class="el" href="group__all__public.html#ga674b73c9b8813f35e41009428cbc80f9">Apop_notify</a> macro. For example, <a class="el" href="group__all__public.html#ga02cf6319da103f9bfe55dfbbc7675536">apop_query</a> and friends will print the query sent to the database engine iff <code>apop_opts.verbose &gt;=2</code> (which is useful when building complex queries). The diagnostics attempt to follow the same verbosity scale as the warning messages.</p>
<h1><a class="anchor" id="Stopping"></a>
Stopping</h1>
<p>Warnings and errors never halt processing. It is up to the calling function to decide whether to stop.</p>
<p>When running the program under a debugger, this is an annoyance: we want to stop as soon as a problem turns up.</p>
<p>The global variable <code>apop_opts.stop_on_warning</code> changes when the system halts:</p>
<p><code>'n'</code>: never halt. If you were using Apophenia to support a user-friendly GUI, for example, you would use this mode.<br />
 The default: if the variable is <code>'\0'</code> (the default), halt on severe errors, continue on all warnings.<br />
 <code>'v'</code>: If the verbosity level of the warning is such that the warning would print to screen, then halt; if the warning message would be filtered out by your verbosity level, continue.<br />
 <code>'w'</code>: Halt on all errors or warnings, including those below your verbosity threshold.</p>
<p>See the documentation for individual functions for details on how each reports errors to the caller and the level at which warnings are posted.</p>
<h1><a class="anchor" id="Legi"></a>
Legible output</h1>
<p>The output routines handle four sinks for your output. There is a global variable that you can use for small projects where all data will go to the same place.</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_type = <span class="charliteral">&#39;f&#39;</span>; <span class="comment">//named file</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_type = <span class="charliteral">&#39;p&#39;</span>; <span class="comment">//a pipe or already-opened file</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_type = <span class="charliteral">&#39;d&#39;</span>; <span class="comment">//the database</span></div>
</div><!-- fragment --><p>You can also set the output type, the name of the output file or table, and other options via arguments to individual calls to output functions. See <a class="el" href="group__all__public.html#ga4748bf59f5441cd27e5b93056c7ec1c7">apop_prep_output</a> for the list of options.</p>
<p>C makes minimal distinction between pipes and files, so you can set a pipe or file as output and send all output there until further notice:</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_type = <span class="charliteral">&#39;p&#39;</span>;</div>
<div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_pipe = popen(<span class="stringliteral">&quot;gnuplot&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">apop_plot_lattice(...); <span class="comment">//see https://github.com/b-k/Apophenia/wiki/gnuplot_snippets</span></div>
<div class="line">fclose(<a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_pipe);</div>
<div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_pipe = fopen(<span class="stringliteral">&quot;newfile&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a class="code" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>(set1);</div>
<div class="line">fprintf(<a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.output_pipe, <span class="stringliteral">&quot;\nNow set 2:\n&quot;</span>);</div>
<div class="line"><a class="code" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>(set2);</div>
</div><!-- fragment --><p>Continuing the example, you can always override the global data with a specific request: </p><div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga6e68deb42339cf6068ab6e741237918d">apop_vector_print</a>(v, <span class="stringliteral">&quot;vectorfile&quot;</span>); <span class="comment">//put vectors in a separate file</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga50915e9992a7cc880807cc266e9f5166">apop_matrix_print</a>(m, <span class="stringliteral">&quot;matrix_table&quot;</span>, .output_type = <span class="charliteral">&#39;d&#39;</span>); <span class="comment">//write to the db</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga50915e9992a7cc880807cc266e9f5166">apop_matrix_print</a>(m, .output_pipe = stdout);  <span class="comment">//now show the same matrix on screen</span></div>
</div><!-- fragment --><p>I will first look to the input file name, then the input pipe, then the global <code>output_pipe</code>, in that order, to determine to where I should write. Some combinations (like output type = <code>'d'</code> and only a pipe) don't make sense, and I'll try to warn you about those.</p>
<p>What if you have too much output and would like to use a pager, like <code>less</code> or <code>more</code>? In C and POSIX terminology, you're asking to pipe your output to a paging program. Here is the form: </p><div class="fragment"><div class="line">FILE *lesspipe = popen(<span class="stringliteral">&quot;less&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">assert(lesspipe);</div>
<div class="line"><a class="code" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>(your_data_set, .output_pipe=lesspipe);</div>
<div class="line">pclose(lesspipe);</div>
</div><!-- fragment --><p> <code>popen</code> will search your usual program path for <code>less</code>, so you don't have to give a full path.</p>
<ul>
<li><a class="el" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a> </li>
<li><a class="el" href="group__all__public.html#ga50915e9992a7cc880807cc266e9f5166">apop_matrix_print</a> </li>
<li><a class="el" href="group__all__public.html#ga6e68deb42339cf6068ab6e741237918d">apop_vector_print</a> </li>
<li>apop_data_show : alias for <a class="el" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a> limited to <code>stdout</code>.</li>
</ul>
<h1><a class="anchor" id="sqlsec"></a>
About SQL, the syntax for querying databases</h1>
<p>For a reference, your best bet is the <a href="http://www.sqlite.org/lang.html">Structured Query Language reference</a> for SQLite. For a tutorial; there is an abundance of <a href="http://www.google.com/search?q=sql+tutorial">tutorials online</a>. Here is a nice blog <a href="http://fluff.info/blog/arch/00000118.htm">entry</a> about complementaries between SQL and matrix manipulation packages.</p>
<p>Apophenia currently supports two database engines: SQLite and mySQL/mariaDB. SQLite is the default, because it is simpler and generally more easygoing than mySQL, and supports in-memory databases.</p>
<p>The global <code>apop_opts.db_engine</code> is initially <code>NUL</code>, indicating no preference for a database engine. You can explicitly set it:</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a9c128a43c2e53c7639ce4ddb0cef92f6">db_engine</a>=<span class="charliteral">&#39;s&#39;</span> <span class="comment">//use SQLite</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga7975faa07196cf463ec261ff0ddc3ccc">apop_opts</a>.<a class="code" href="structapop__opts__type.html#a9c128a43c2e53c7639ce4ddb0cef92f6">db_engine</a>=<span class="charliteral">&#39;m&#39;</span> <span class="comment">//use mySQL/mariaDB</span></div>
</div><!-- fragment --><p>If <code>apop_opts.db_engine</code> is still <code>NUL</code> on your first database operation, then I will check for an environment variable <code>APOP_DB_ENGINE</code>, and set <code>apop_opts.db_engine='m'</code> if it is found and matches (case insensitive) <code>mariadb</code> or <code>mysql</code>.</p>
<div class="fragment"><div class="line">export APOP_DB_ENGINE=mariadb</div>
<div class="line"><a class="code" href="group__all__public.html#gabd00e16791a970631c3ed4ac3487da46">apop_text_to_db</a> indata mtab db_for_maria</div>
<div class="line"></div>
<div class="line">unset APOP_DB_ENGINE</div>
<div class="line"><a class="code" href="group__all__public.html#gabd00e16791a970631c3ed4ac3487da46">apop_text_to_db</a> indata stab db_for_sqlite.db</div>
</div><!-- fragment --><p>Write <a class="el" href="gentle.html#apop_data">apop_data</a> sets to the database using <a class="el" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>, with <code>.output_type='d'</code>.</p>
<ul>
<li>Column names are inserted if there are any. If there are, all dots are converted to underscores. Otherwise, the columns will be named <code>c1</code>, <code>c2</code>, <code>c3</code>, &amp;c. </li>
<li>If <a class="el" href="structapop__opts__type.html">apop_opts.db_name_column</a> is not blank (the default is <code>"row_name"</code>), then a so-named column is created, and the row names are placed there. </li>
<li>If there are weights, they will be the last column of the table, and the column will be named <code>weights</code>. </li>
<li>If the table exists; append to. If the table does not exist, create. So perhaps call <a class="el" href="group__all__public.html#ga01d501ca84ade92bc72fd4f67a617f64">apop_table_exists</a> <code>("tabname", 'd')</code> to ensure that the table is removed ahead of time. </li>
<li>Use <a class="el" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a> <code>(data, "tabname", .output_type='d', .output_append='w')</code> to overwrite a new table or with <code>.output_append='a'</code> to append. </li>
<li>If your data set has zero data (i.e., is just a list of column names or is entirely blank), <a class="el" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a> returns without creating anything in the database. </li>
<li>Especially if you are using a pre-2007 version of SQLite, there may be a speed gain to wrapping the call to this function in a begin/commit pair:</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga02cf6319da103f9bfe55dfbbc7675536">apop_query</a>(<span class="stringliteral">&quot;begin;&quot;</span>);</div>
<div class="line"><a class="code" href="group__all__public.html#gab45a848e5dbcaf82b5b95cd03f7b396a">apop_data_print</a>(dataset, .output_name=<span class="stringliteral">&quot;dbtab&quot;</span>, .output_type=<span class="charliteral">&#39;d&#39;</span>);</div>
<div class="line"><a class="code" href="group__all__public.html#ga02cf6319da103f9bfe55dfbbc7675536">apop_query</a>(<span class="stringliteral">&quot;commit;&quot;</span>);</div>
</div><!-- fragment --><p>Finally, Apophenia provides a few nonstandard SQL functions to facilitate math via database; see <a class="el" href="dbs.html#db_moments">Database moments (plus pow()!)</a>.</p>
<h1><a class="anchor" id="threads"></a>
Threading</h1>
<p>Apophenia uses OpenMP for threading. You generally do not need to know how OpenMP works to use Apophenia, and many points of work will thread without your doing anything.</p>
<ul>
<li>All functions strive to be thread-safe. Part of how this is achieved is that static variables are marked as thread-local or atomic, as per the C standard. There still exist compilers that can't implement thread-local or atomic variables, in which case your safest bet is to set OMP's thread count to one as below (or get a new compiler).</li>
</ul>
<ul>
<li>Some functions modify their inputs. It is up to you to use those functions in a thread-safe manner. The <a class="el" href="group__all__public.html#gaa06b6ab6ec9f78f305b1dacc8ec2efd3">apop_matrix_realloc</a> handles states and global variables correctly in a threaded environment, but if you have two threads resizing the same <code>gsl_matrix</code> at the same time, you're going to have problems.</li>
</ul>
<ul>
<li>There are few compilers that don't support OpenMP. Clang on MacOS may be the only current mainstream example as of this writing, and they are hard at work on implementing it. In the mean time, when compiling on such a system all work will be single-threaded.</li>
</ul>
<ul>
<li>Set the maximum number of threads to <code>N</code> with the environment variable</li>
</ul>
<div class="fragment"><div class="line">export OMP_NUM_THREADS N</div>
</div><!-- fragment --><p>or the C function</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line">omp_set_num_threads(N);</div>
</div><!-- fragment --><p>Use one of these methods with <code>N=1</code> if you want a single-threaded program. You can return later to using all available threads via <code>omp_set_num_threads(omp_get_num_procs())</code>.</p>
<ul>
<li><a class="el" href="group__all__public.html#gaacff3707e418a067104c77c410b43f69">apop_map</a> and friends distribute their <code>for</code> loop over the input <a class="el" href="gentle.html#apop_data">apop_data</a> set across multiple threads. Therefore, be careful to send thread-unsafe functions to it only after calling <code>omp_set_num_threads(1)</code>.</li>
</ul>
<ul>
<li>There are a few functions, like <a class="el" href="group__all__public.html#ga4e204cdc7429bef3ca2efb83453fe77a">apop_model_draws</a>, that rely on <a class="el" href="group__all__public.html#gaacff3707e418a067104c77c410b43f69">apop_map</a>, and therefore also thread by default.</li>
</ul>
<ul>
<li>The function <a class="el" href="group__all__public.html#ga1e829ce2396bf05ab10460bcc37aeeab">apop_rng_get_thread</a> retrieves a statically-stored RNG specific to a given thread. Therefore, if you use that function in the place of a <code>gsl_rng</code>, you can parallelize functions that make random draws.</li>
</ul>
<ul>
<li><a class="el" href="group__all__public.html#ga1e829ce2396bf05ab10460bcc37aeeab">apop_rng_get_thread</a> allocates its store of threads using <code>apop_opts.rng_seed</code>, then incrementing that seed by one. You thus probably have threads with seeds 479901, 479902, 479903, .... [If you have a better way to do it, please feel free to modify the code to implement your improvement and submit a pull request on Github.]</li>
</ul>
<p>See <a href="http://modelingwithdata.org/arch/00000175.htm">this tutorial on C threading</a> if you would like to know more, or are unsure about whether your functions are thread-safe or not. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
</body></html>

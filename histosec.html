<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
     <title>Apophenia: a library for scientific computing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
     <link rel="stylesheet" href="typical.css" type="text/css" >
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="typical.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<center><table cellpadding=10pt>
<tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td>
<td><table>
    <tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
    <tr><td><div class="qindex"> <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="group__all__public.html">Index </a>  |         <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
                <!-- <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
                                  </td></tr></table></center>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('histosec.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Empirical distributions and PMFs (probability mass functions) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a> model wraps an <a class="el" href="gentle.html#apop_data">apop_data</a> set so it can be read as an empirical model, with a likelihood function (equal to the associated weight for observed values and zero for unobserved values), a random number generator (which simply makes weighted random draws from the data), and so on. Setting it up is a model estimation from data like any other, done via <a class="el" href="group__all__public.html#gaf78221aa4167b7b52bdd0a26aab8e576">apop_estimate</a>(<code>your_data</code>, <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>).</p>
<p>You have the option of cleaning up the data before turning it into a PMF. For example...</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga1c92706fa6e3e58e66bfb649cbe3dc28">apop_data_pmf_compress</a>(your_data);          <span class="comment">//remove duplicates</span></div>
<div class="line"><a class="code" href="group__all__public.html#ga721ed20cd27f7d8ae4f752f48ff69ef4">apop_data_sort</a>(your_data);</div>
<div class="line"><a class="code" href="group__all__public.html#ga194ad92b1bc632ba1d13d9958c7b5b4d">apop_vector_normalize</a>(your_data-&gt;weights);  <span class="comment">//weights sum to one</span></div>
<div class="line"><a class="code" href="structapop__model.html">apop_model</a> *a_pmf = <a class="code" href="group__all__public.html#gaf78221aa4167b7b52bdd0a26aab8e576">apop_estimate</a>(your_data, <a class="code" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>);</div>
</div><!-- fragment --><p>These are largely optional.</p>
<ul>
<li>The CDF is calculated based on the percent of the weights between the zeroth row of the PMF and the row specified. This generally makes more sense after <a class="el" href="group__all__public.html#ga721ed20cd27f7d8ae4f752f48ff69ef4">apop_data_sort</a>. </li>
<li>Compression produces a corresponding improvement in efficiency when first calculating CDFs, but is otherwise not necessary. </li>
<li>Sorting or normalizing is not necessary for making draws or getting a likelihood or log likelihood.</li>
</ul>
<p>It is the <code>weights</code> vector that holds the density represented by each row; the rest of the row represents the coordinates of that density. If the input data set has no <code>weights</code> segment, then I assume that all rows have equal weight.</p>
<p>For a PMF model, the <code>parameters</code> are <code>NULL</code>, and the <code>data</code> itself is used for calculation. Therefore, modifying the data post-estimation can break some internal settings set during estimation. If you modify the data, throw away any existing PMFs (via <a class="el" href="group__all__public.html#gab29755a86b82dfe31cdd01d55431cc09">apop_model_free</a>) and re-estimate a new one.</p>
<h1><a class="anchor" id="histocompare"></a>
Comparing histograms</h1>
<p>Using <a class="el" href="group__all__public.html#ga1c92706fa6e3e58e66bfb649cbe3dc28">apop_data_pmf_compress</a> puts the data into one bin for each unique value in the data set. You may instead want bins of fixed with, in the style of a histogram, which you can get via <a class="el" href="group__all__public.html#ga2cfd79041dd974938d57e5674370572d">apop_data_to_bins</a>. It requires a bin specification. If you send a <code>NULL</code> binspec, then the offset is zero and the bin size is big enough to ensure that there are <img class="formulaInl" alt="$\sqrt{N}$" src="form_18.png"/> bins from minimum to maximum. The binspec will be added as a page to the data set, named <code>"&lt;binspec&gt;"</code>. See the <a class="el" href="group__all__public.html#ga2cfd79041dd974938d57e5674370572d">apop_data_to_bins</a> documentation on how to write a custom bin spec.</p>
<p>There are a few ways of testing the claim that one distribution equals another, typically an empirical PMF versus a smooth theoretical distribution. In both cases, you will need two distributions based on the same binspec.</p>
<p>For example, if you do not have a prior binspec in mind, then you can use the one generated by the first call to the histogram binning function to make sure that the second data set is in sync:</p>
<div class="fragment"><div class="line"><a class="code" href="group__all__public.html#ga2cfd79041dd974938d57e5674370572d">apop_data_to_bins</a>(first_set, NULL);</div>
<div class="line"><a class="code" href="group__all__public.html#ga2cfd79041dd974938d57e5674370572d">apop_data_to_bins</a>(second_set, <a class="code" href="group__all__public.html#ga8b83117b7900b3ae639d36459500becd">apop_data_get_page</a>(first_set, <span class="stringliteral">&quot;&lt;binspec&gt;&quot;</span>));</div>
</div><!-- fragment --><p>You can use <a class="el" href="group__all__public.html#gacc11c9f057815789a5442c53fc8616f5">apop_test_kolmogorov</a> or <a class="el" href="group__all__public.html#ga167275d050eef00578390e26b552bc44">apop_histograms_test_goodness_of_fit</a> to generate the appropriate statistics from the pairs of bins.</p>
<p>Kernel density estimation will produce a smoothed PDF. See <a class="el" href="group__models.html#gaded18b6bf8bd63a53f7b72ed5f27fdb5">apop_kernel_density</a> for details. Or, use <a class="el" href="group__all__public.html#ga155f2cdf5d3fa717bea0a62704a04550">apop_vector_moving_average</a> for a simpler smoothing method.</p>
<ul>
<li><a class="el" href="group__all__public.html#ga1c92706fa6e3e58e66bfb649cbe3dc28">apop_data_pmf_compress()</a> : merge together redundant rows in a data set before calling <a class="el" href="group__all__public.html#gaf78221aa4167b7b52bdd0a26aab8e576">apop_estimate</a>(<code>your_data</code>, <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>); optional. </li>
<li><a class="el" href="group__all__public.html#ga155f2cdf5d3fa717bea0a62704a04550">apop_vector_moving_average()</a> : smooth a vector (e.g., <code>your_pmf-&gt;data-&gt;weights</code>) via moving average. </li>
<li><a class="el" href="group__all__public.html#ga167275d050eef00578390e26b552bc44">apop_histograms_test_goodness_of_fit()</a> : goodness-of-fit via <img class="formulaInl" alt="$\chi^2$" src="form_16.png"/> statistic </li>
<li><a class="el" href="group__all__public.html#gacc11c9f057815789a5442c53fc8616f5">apop_test_kolmogorov()</a> : goodness-of-fit via Kolmogorov-Smirnov statistic </li>
<li><a class="el" href="group__all__public.html#gaa56d1f280fa5774300d10616cf24a3c4">apop_kl_divergence()</a> : measure the information loss from one (typically empirical) distribution to another distribution. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html> <head>
     <title>Apophenia: a library for scientific computing</title>
<!-- Google is watching. -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-134313-2";
urchinTracker();
</script>
     <link rel="stylesheet" href="typical.css" type="text/css" >
     <script  type="text/javascript" language="JavaScript" src="tree.js"></script>
</head><body>
     <center><table cellpadding=10pt>
     <tr> <td><img width=140px src=flake.gif alt="Patterns in static"></td> 
    <td><table>
     	<tr> <td><center><h2><a href="http://apophenia.info">Apophenia</a></h2></center></td></tr>
<tr><td><div class="qindex"><a class="qindex" href="index.html">&nbsp;Intro</a> | <a class="qindex" href="outline.html">Outline</a> | <a class="qindex" href="globals.html">Index</a> <!--| <a class="qindex" href="files.html">File&nbsp;List&nbsp;</a> -->  </div></td></tr></table>
	</td></tr></table></center>
    <div> <!--Doxygen generates an extra </div>.-->
<!-- Generated by Doxygen 1.8.9.1 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">apop_model.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa86381a72949fd3ffafefa87e3f51a4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#gaa86381a72949fd3ffafefa87e3f51a4f">apop_model_clear</a> (<a class="el" href="structapop__data.html">apop_data</a> *data, <a class="el" href="structapop__model.html">apop_model</a> *model)</td></tr>
<tr class="separator:gaa86381a72949fd3ffafefa87e3f51a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab29755a86b82dfe31cdd01d55431cc09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#gab29755a86b82dfe31cdd01d55431cc09">apop_model_free</a> (<a class="el" href="structapop__model.html">apop_model</a> *free_me)</td></tr>
<tr class="separator:gab29755a86b82dfe31cdd01d55431cc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7bf9adff9b97c60c5839ae72ba4fb7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__output.html#gab7bf9adff9b97c60c5839ae72ba4fb7f">apop_model_print</a> (<a class="el" href="structapop__model.html">apop_model</a> *print_me, FILE *ap)</td></tr>
<tr class="separator:gab7bf9adff9b97c60c5839ae72ba4fb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa08e29db38e8dcc111899c942022d9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fa08e29db38e8dcc111899c942022d9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>apop_model_show</b> (<a class="el" href="structapop__model.html">apop_model</a> *print_me)</td></tr>
<tr class="separator:a4fa08e29db38e8dcc111899c942022d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87d3a65f43071b9d61d9edd59249c629"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga87d3a65f43071b9d61d9edd59249c629">apop_model_copy</a> (<a class="el" href="structapop__model.html">apop_model</a> *in)</td></tr>
<tr class="separator:ga87d3a65f43071b9d61d9edd59249c629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b818ff6672229f10c3e559ba9cffb65"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b818ff6672229f10c3e559ba9cffb65"></a>
<a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>apop_model_set_parameters_base</b> (<a class="el" href="structapop__model.html">apop_model</a> *in, double ap[])</td></tr>
<tr class="separator:a0b818ff6672229f10c3e559ba9cffb65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c0598e5aca68949939a189bd4ce24ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga2c0598e5aca68949939a189bd4ce24ca">apop_estimate</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga2c0598e5aca68949939a189bd4ce24ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2510c7df8ccd834732ee208005738b0f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga2510c7df8ccd834732ee208005738b0f">apop_p</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga2510c7df8ccd834732ee208005738b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e160c8d0a0ee660c89fb3f6de2af89c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga5e160c8d0a0ee660c89fb3f6de2af89c">apop_log_likelihood</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga5e160c8d0a0ee660c89fb3f6de2af89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga228b013bc80f308900882312cab93eb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga228b013bc80f308900882312cab93eb3">apop_score</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, gsl_vector *out, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga228b013bc80f308900882312cab93eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4ceb0267fe56c68a45019798204fed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8b4ceb0267fe56c68a45019798204fed"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Apop_settings_init</b> (<a class="el" href="apop_8h.html#a47600802191d9ccf5d48fce70e754294">Apop_settings_copy</a>(apop_pm, Apop_varad_set(rng, NULL);Apop_varad_set(draws, 1e4);)</td></tr>
<tr class="separator:a8b4ceb0267fe56c68a45019798204fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92355da54ab91a8dee22192ae68a37d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga92355da54ab91a8dee22192ae68a37d0">apop_parameter_model</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga92355da54ab91a8dee22192ae68a37d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a700ba4b9678433d2f84938c1c515f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apop__model_8c.html#ac8a700ba4b9678433d2f84938c1c515f">apop_model_metropolis_draw</a> (double *out, gsl_rng *rng, <a class="el" href="structapop__model.html">apop_model</a> *params)</td></tr>
<tr class="separator:ac8a700ba4b9678433d2f84938c1c515f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87f15cd1923ed7b5b46e52a77ca1dfef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga87f15cd1923ed7b5b46e52a77ca1dfef">apop_draw</a> (double *out, gsl_rng *r, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga87f15cd1923ed7b5b46e52a77ca1dfef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga373ccc4cb87b162d62d07a2685ccd8ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga373ccc4cb87b162d62d07a2685ccd8ba">apop_prep</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga373ccc4cb87b162d62d07a2685ccd8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga867f0b8df261866bb18e9040871c51f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structapop__data.html">apop_data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#ga867f0b8df261866bb18e9040871c51f0">apop_predict</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:ga867f0b8df261866bb18e9040871c51f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee16258d3e52671e254f3ce03bca7754"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a> (<a class="el" href="structapop__data.html">apop_data</a> *d, <a class="el" href="structapop__model.html">apop_model</a> *m)</td></tr>
<tr class="separator:gaee16258d3e52671e254f3ce03bca7754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48a62e79fe52b21bf1a74e216d8e8c5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af48a62e79fe52b21bf1a74e216d8e8c5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Apop_settings_init</b> (<a class="el" href="group__models.html#gaee16258d3e52671e254f3ce03bca7754">apop_cdf</a>, Apop_varad_set(draws, 1e4);Apop_varad_set(rng, NULL);out-&gt;draws_refcount=malloc(sizeof(int));*out-&gt;draws_refcount=1;) Apop_settings_free(apop_cdf</td></tr>
<tr class="separator:af48a62e79fe52b21bf1a74e216d8e8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3226563c0b548526db8b5bfbda3f8051"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3226563c0b548526db8b5bfbda3f8051"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>if</b> (in-&gt;draws_made &amp;&amp;!--*in-&gt;draws_refcount) gsl_matrix_free(in-&gt; draws_made)</td></tr>
<tr class="separator:a3226563c0b548526db8b5bfbda3f8051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7482aa1d411497cbd70295bee617de4d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7482aa1d411497cbd70295bee617de4d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>apop_model_free</b> (in-&gt;cdf_model)</td></tr>
<tr class="separator:a7482aa1d411497cbd70295bee617de4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a79d57058375e37ef6c59f0bb43e62585"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a79d57058375e37ef6c59f0bb43e62585"></a>
<a class="el" href="structapop__model.html">apop_model</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>apop_swap_model</b></td></tr>
<tr class="separator:a79d57058375e37ef6c59f0bb43e62585"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>sets up the estimate structure which outputs from the various regressions and MLEs. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac8a700ba4b9678433d2f84938c1c515f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int apop_model_metropolis_draw </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_rng *&#160;</td>
          <td class="paramname"><em>rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structapop__model.html">apop_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The draw method for models estimated via <a class="el" href="apop__mcmc_8c.html#a733c60eab5b69d89729565a3aeeb15d9">apop_model_metropolis</a>.</p>
<p>That method produces an <a class="el" href="group__models.html#gaca8f3323c57e0223a9f3c0f991c9760e">apop_pmf</a>, typically with a few thousand draws from the model in a batch. If you want to get a single next step from the Markov chain, use this.</p>
<p>A Markov chain works by making a new draw and then accepting or rejecting the draw. If the draw is rejected, the last value is reported as the next step in the chain. Users sometimes mitigate this repetition by making a batch of draws (say, ten at a time) and using only the last.</p>
<p>If you run this without first running <a class="el" href="apop__mcmc_8c.html#a733c60eab5b69d89729565a3aeeb15d9">apop_model_metropolis</a>, I will run it for you, meaning that there will be an initial burn-in period before the first draw that can be reported to you. That run is done using <code>model-&gt;data</code> as input.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>An array of <code>doubles</code>, which will hold the draw, in the style of <a class="el" href="group__models.html#ga87f15cd1923ed7b5b46e52a77ca1dfef">apop_draw</a>. </td></tr>
    <tr><td class="paramname">rng</td><td>A <code>gsl_rng</code>, already initialized, probably via <a class="el" href="group__convenience__fns.html#gada044cf02135422a9f9292b6054c86dd">apop_rng_alloc</a>. </td></tr>
    <tr><td class="paramname">model</td><td>A model which was probably already run through <a class="el" href="apop__mcmc_8c.html#a733c60eab5b69d89729565a3aeeb15d9">apop_model_metropolis</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On return, <code>out</code> is filled with the next step in the Markov chain. The <code>-&gt;data</code> element of the PMF model is extended to include the additional steps in the chain. If a proposal failed the model constraints, then return 1; else return 0. See the notes in the documentation for <a class="el" href="apop__mcmc_8c.html#a733c60eab5b69d89729565a3aeeb15d9">apop_model_metropolis</a>.</dd></dl>
<ul>
<li>After pulling the attached settings group, the parent model is ignored. One expects that <code>base_model</code> in the mcmc settings group == the parent model.</li>
</ul>
<ul>
<li>If your settings break the model parameters into several chunks, this function returns after stepping through all chunks. </li>
</ul>

</div>
</div>
</div><!-- contents -->
<p><p>
<div class="tiny">Autogenerated by doxygen on Mon Apr 20 2015.</div></body></html>
